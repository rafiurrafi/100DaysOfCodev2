<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Playing with dom</title>
  </head>
  <body>
    <style>
      .copy-item {
        max-width: 50px;
        padding: 10px 20px;
        border: 1px solid royalblue;
        position: absolute;
        cursor: pointer;
      }
      .clone-item {
        color: white;
      }
      .garbage {
        position: absolute;
        bottom: 1rem;
        right: 1rem;
        height: 70px;
        width: 70px;
        background-color: black;
      }
    </style>
    <h2>üêï‚Äçü¶∫DOMüíÉ</h2>
    <div class="copy-items">
      <div class="copy-item">You</div>
      <div class="copy-item">have</div>
      <div class="copy-item">nice</div>
      <div class="copy-item">Cat</div>
    </div>
    <div class="garbage"></div>
    <script>
      const copyItems = document.querySelectorAll(".copy-item");
      const garbage = document.querySelector(".garbage");
      const holder = {};
      copyItems.forEach((item, index) => {
        item.style.left = index * 80 + "px";
        item.addEventListener("click", function () {
          holder.obj = item.cloneNode(true);

          holder.obj.style.backgroundColor = getColor();
          holder.obj.style.cursor = "move";
          holder.obj.startX = item.offsetLeft;
          holder.obj.startY = item.offsetTop;

          holder.obj.moves = Math.floor(Math.random() * 25);
          holder.obj.int = setInterval(mover, 25);

          function mover() {
            if (holder.obj.moves <= 0) clearInterval(holder.obj.int);
            else {
              holder.obj.moves--;
              holder.obj.startX += 1;
              holder.obj.startY += 10;
              holder.obj.style.left = holder.obj.startX + "px";
              holder.obj.style.top = holder.obj.startY + "px";
            }
          }
          holder.obj.classList.add("clone-item");
          dragger(holder.obj);
          document.body.appendChild(holder.obj);
        });
      });
      function dragger(element) {
        let pos = {};
        element.onmousedown = dragMouse;
        function dragMouse(e) {
          pos.x = e.clientX;
          pos.y = e.clientY;

          document.onmouseup = function () {
            document.onmouseup = null;
            document.onmousemove = null;
          };
          document.onmousemove = function (e) {
            if (isColide(element)) {
              element.onmousedown = null;
              element.parentElement.removeChild(element);
            } else console.log("ok");
            pos.updatedX = pos.x - e.clientX;
            pos.updatedY = pos.y - e.clientY;

            pos.x = e.clientX;
            pos.y = e.clientY;

            element.style.top = element.offsetTop - pos.updatedY + "px";
            element.style.left = element.offsetLeft - pos.updatedX + "px";
          };
          function isColide(element) {
            // const aBoundery = element.getBoundingClientRect();
            // const bBoundery = garbage.getBoundingClientRect();
            const a = element.getBoundingClientRect();
            const b = garbage.getBoundingClientRect();

            return !(
              a.right < b.left ||
              a.left > b.right ||
              a.bottom < b.top ||
              a.top > b.bottom
            );
          }
        }
      }
      function getColor() {
        const c = () => {
          const hex = Math.floor(Math.random() * 255).toString(16);
          const updatedHex = ("0" + hex).substr(-2);
          return updatedHex;
        };
        const generatedColor = "#" + c() + c() + c();
        return generatedColor;
      }
    </script>
  </body>
</html>
